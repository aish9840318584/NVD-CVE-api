from flask import Flask, render_template, request
from database import display_vulnerabilities
from d2 import fetch_cve_details
app = Flask(__name__)

@app.route('/')
@app.route('/cves/list')
def cve_list():
    results_per_page = int(request.args.get('results_per_page', 10))  
    page_number = request.args.get('page_number', 1)  
    data, total_records = display_vulnerabilities(page_number=page_number, results_per_page=results_per_page)
    return render_template('index.html', data=data, total_records=total_records, results_per_page=results_per_page)

@app.route('/cves/<cve_id>')
def cve_details(cve_id):
    cve_details = fetch_cve_details(cve_id)
    if cve_details:
        return render_template('cve_details.html', cve_details=cve_details)
    else:
        return "CVE ID not found", 404

if __name__ == "__main__":
    app.run(debug=True)

